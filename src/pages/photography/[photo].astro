---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import GalleryView from "@/components/views/GalleryView.astro";

export async function getStaticPaths() {
  const photos = await getCollection("photos");

  return photos.map((photo) => ({
    params: { photo: photo.id },
    props: { selectedPhoto: photo },
  }));
}

const { selectedPhoto } = Astro.props;
const photos = await getCollection("photos");

// Set up meta tags for the specific photo
const title = `Joshua Heiland | Photographs | ${selectedPhoto.data.title}`;
const description = `View ${selectedPhoto.data.title} and other photographs by Joshua Heiland`;
---

<Layout title={title}>
  <!-- Open Graph meta tags for social sharing -->
  <meta slot="head" property="og:title" content={title} />
  <meta slot="head" property="og:description" content={description} />
  <meta slot="head" property="og:image" content={selectedPhoto.data.imageUrl} />
  <meta slot="head" property="og:url" content={Astro.url} />
  <meta slot="head" property="og:type" content="article" />

  <!-- Twitter meta tags -->
  <meta slot="head" name="twitter:card" content="summary_large_image" />
  <meta
    slot="head"
    name="twitter:image"
    content={selectedPhoto.data.imageUrl}
  />
  <meta slot="head" name="twitter:title" content={title} />
  <meta slot="head" name="twitter:description" content={description} />

  <GalleryView
    photos={photos}
    backHref="/"
    backLabel="Home"
    sectionTitle="Moments I've Noticed"
  />
</Layout>
