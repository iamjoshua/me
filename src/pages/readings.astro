---
import Layout from "../layouts/Layout.astro";
import Readings from "../components/Readings.astro";
import TwoColumnView from "../components/views/TwoColumnView.astro";
import Back from "../components/elements/Back.astro";
---

<Layout>
  <TwoColumnView>
    <div slot="sidebar">
      <Back href="/" label="Home" />
      <div
        class="text-3xl md:text-4xl font-light text-gray-700 italic leading-tight font-[Crimson_Text] text-center lg:text-left flex justify-center lg:justify-start"
      >
        Things I've read
      </div>

      <!-- Filter buttons -->
      <div
        class="absolute left-0 w-full px-5 lg:px-0 space-y-2 mt-12 lg:mt-12 mb-6"
      >
        <div class="flex flex-wrap gap-2 justify-center lg:justify-start">
          <button
            class="filter-btn px-3 py-1 text-sm border border-gray-300 rounded-full text-gray-700 hover:border-gray-400 transition-colors"
            data-filter="all"
          >
            All
          </button>
          <button
            class="filter-btn px-3 py-1 text-sm border border-gray-300 rounded-full text-gray-700 hover:border-gray-400 transition-colors"
            data-filter="philosophy"
          >
            Philosophy
          </button>
          <button
            class="filter-btn px-3 py-1 text-sm border border-gray-300 rounded-full text-gray-700 hover:border-gray-400 transition-colors"
            data-filter="fiction"
          >
            Fiction
          </button>
          <button
            class="filter-btn px-3 py-1 text-sm border border-gray-300 rounded-full text-gray-700 hover:border-gray-400 transition-colors"
            data-filter="science"
          >
            Science
          </button>
          <button
            class="filter-btn px-3 py-1 text-sm border border-gray-300 rounded-full text-gray-700 hover:border-gray-400 transition-colors"
            data-filter="science fiction"
          >
            Science Fiction
          </button>
          <button
            class="filter-btn px-3 py-1 text-sm border border-gray-300 rounded-full text-gray-700 hover:border-gray-400 transition-colors"
            data-filter="business"
          >
            Business
          </button>
        </div>
      </div>
    </div>

    <h1
      class="hidden text-7xl md:text-6xl lg:text-7xl xl:text-7xl xl:tracking-tight lg:leading-18 font-bold leading-none tracking-tighter text-neutral-800"
    >
      Books
    </h1>

    <div slot="main">
      <div class="flex flex-wrap gap-5">
        <Readings />
      </div>
    </div>
  </TwoColumnView>
</Layout>

<script>
  function initializeFilters() {
    const filterButtons = document.querySelectorAll(".filter-btn");
    const readingItems = document.querySelectorAll(".reading-item");

    filterButtons.forEach((button) => {
      button.addEventListener("click", () => {
        const filter = button.getAttribute("data-filter");

        // Update active button
        filterButtons.forEach((btn) => {
          btn.classList.remove("border-gray-600", "bg-gray-100");
          btn.classList.add("border-gray-300");
        });
        button.classList.remove("border-gray-300");
        button.classList.add("border-gray-600", "bg-gray-100");

        // Filter readings
        readingItems.forEach((item) => {
          const category = item.getAttribute("data-category");
          if (filter === "all" || category === filter) {
            item.style.display = "";
          } else {
            item.style.display = "none";
          }
        });
      });
    });

    // Set initial state - show all
    const allButton = document.querySelector('[data-filter="all"]');
    if (allButton) {
      allButton.classList.add("border-gray-600", "bg-gray-100");
      allButton.classList.remove("border-gray-300");
    }
  }

  // Initialize on page load
  document.addEventListener("DOMContentLoaded", initializeFilters);

  // Re-initialize after navigation (for view transitions)
  document.addEventListener("astro:page-load", initializeFilters);
</script>
