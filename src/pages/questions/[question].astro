---
import { getCollection, getEntry, render } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import WritingView from "@/components/views/WritingView.astro";
import Header from "@/components/elements/Header.astro";

export async function getStaticPaths() {
  const questions = await getCollection("questions");
  return questions.map((question) => ({
    params: { question: question.id },
  }));
}

const { question } = Astro.params;
const entry = await getEntry("questions", question);

if (!entry) {
  return Astro.redirect("/404");
}

const { Content } = await render(entry);
---

<Layout title={entry.data.title}>
  <WritingView
    title={entry.data.title}
    backHref="/questions"
    backLabel="Questions"
    sectionLabel="Consciousness"
    sectionTitle="Phenomenal Character"
    excerpt={entry.data.elaboration}
    editedAt={entry.data.editedAt}
    tags={entry.data.tags}
    contentClass="prose-md"
  >
    {
      entry.data.position && (
        <div class="hidden mb-8">
          <Header>My Current Position</Header>
          <p>{entry.data.position}</p>
        </div>
      )
    }
    <Content />
  </WritingView>
</Layout>
